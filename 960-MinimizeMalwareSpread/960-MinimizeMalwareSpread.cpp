// Last updated: 12/8/2025, 11:26:44 PM
class Solution {
public:
    int minMalwareSpread(vector<vector<int>>& graph, vector<int>& initial) {
        vector<int> cc;  // size of connected components;
        unordered_map<int, int> c;  // nodes : components

        int count = 0;
        for (int i = 0; i < graph.size(); ++i) {
            if (c.find(i) == c.end()) {
                int sz = 0;
                stack<int> st;
                st.push(i);
                c[i] = count;
                while (!st.empty()) {
                    int cur = st.top();
                    st.pop();
                    sz++;
                    for (int j = 0; j < graph.size(); ++j) {
                        if (graph[cur][j] == 1 && c.find(j) == c.end()) {
                            st.push(j);
                            c[j] = count;
                        }
                    }
                }
                cc.push_back(sz);
                count++;
            }
        }

        vector<int> infected_cc(cc.size());
        sort(initial.begin(), initial.end());
        for (int m : initial) infected_cc[c[m]]++;

        int remove = initial[0];
        for (int m : initial) {            
            if (infected_cc[c[m]] == 1) {
                if (infected_cc[c[remove]] > 1 || infected_cc[c[remove]] == 1 && cc[c[m]] > cc[c[remove]])
                    remove = m;
            }   
        }

        return remove;
    }
};